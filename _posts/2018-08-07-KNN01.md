---
layout:     post
title:      K-近邻算法(KNN)之概述
subtitle:   《机器学习实战一》
date:       2018-08-07
author:     Jang
header-img: img/post-bg-debug.png
catalog: true
tags:
    - MachineLearning
    - 机器学习实战
---

# 1. KNN概述<br>
k-近邻(KNN,k-NearestNeighbor)算法是一种基本分类与回归方法，我们这里只讨论分类问题中的knn.<br>

k近邻算法的输入为实例的特征向量，对应与特征空间的点；输出为实例的类别，可以取多类。k近邻算法假设给定一个训练数据集，其中的实例类别已定(已打好标签)。分类时，对新的实例，根据其k个最近邻的训练实例的类别，通过多数表决等方式进行预测。因此，k近邻算法不具有显示的学习过程。<br>

k邻近算法实际上利用训练数据集对特征向量空间进行划分，并作为其分类的"模型"。k值的选择、距离度量以及分类决策规则是k近邻算法的三个基本要素。<br>

# 2. KNN原理<br>
## 2.1 KNN工作原理<br>
* a. 假设有一个带有标签的样本数据集(训练样本集)，其中包含每条数据与所属分类的对应关系。
* b. 输入没有标签的新数据后，将新数据的每个特征与样本集中数据对应的特征进行比较。
    *   i. 计算新数据与样本数据集中每条数据的距离。
    *  ii. 对求得的所有距离进行排序(从小到大，越小表示越相似)。
    * iii. 取前k(k一般小于等于20)个样本数据对应的分类标签。
* c. 求k个数据中出现次数最多的分类标签作为新数据的分类

## 2.2 KNN通俗理解<br>
给定一个训练数据集，对新的输入实例，在训练数据集中找到与该实例最近邻的k个实例，这k个实例的多数属于某个类，就把该输入实例分为这个类

## 2.3 KNN开发流程<br>
* 1). 收集数据: 任何方法
* 2). 准备数据：距离计算所需要的数值，最好是结构化的数据格式
* 3). 分析数据：任何方法
* 4). 训练算法：此步骤不适用于k-近邻算法
* 5). 测试算法：计算错误率
* 6). 使用算法：输入样本数据和结构化的输出结果，然后运行k-近邻算法判断输入数据分类属于哪个分类，最后对计算出的分类执行后续处理

## 2.4 KNN算法特点<br>
* 优点：精度高、对异常值不敏感、无数据输入假定
* 缺点：计算复杂度高、空间复杂度高
* 适用数据范围：数值型和标量型

# 3 KNN小结<br>
KNN是一个简单的无显示学习过程，非泛化学习的监督学习模型。在分类和回归中均有应用。

## 3.1 基本原理<br>
简单来说：通过距离度量来计算查询点与每个训练数据点的巨鹿，然后选出与查询点相邻的K个最邻点(K nearest neighbos)，使用分类决策来选出对应的标签来作为该查询点的标签。

## 3.2 KNN三要素<br>
* K的取值<br>
    * 对查询点标签影响显著。k值小的时候 近似误差小，估计差误差大。k值大 近似误差大，估计误差小
    * 如果选择较小的k值，就相当于用较小的邻域中的训练实例进行预测，"学习"的近似误差(approximation error)会减小，只有与输入实例较近的(相似的)训练实例才会对预测结果其作用。但缺点是"学习"的估计误差(estimation error)会增大，预测结果会对近邻的实例点非常敏感。如果近邻的实例点恰巧是噪声，预测就会出错。换句话说，k值的减小就意味着整理模型变得复杂，容易发生过拟合。
    * 如果选择较大的k值，就相当于用较大的邻域中的训练实例进行预测。其优点是可以减少学习的估计误差。但缺点是学习的近似误差会增大。这时与输入实例胶原的训练实例也会对预测起作用，使预测发生错误。
    * 太大太小都不太好，可以用交叉验证来选取合适的k值
    * 近似误差和估计误差，请看这里：https://www.zhihu.com/question/60793482
* 距离度量 Metric/Distance Measure<br>
    距离度量通常为欧式距离(Euclidean distance), 还可以是Minkowski距离或者曼哈顿距离。也可以是地理空间中的一些距离公式。
* 分类决策(decision rule)<br>
    分类决策在分类问题中通常为通过少数服从多数来选取票数最多的标签，在回归问题中通常为K个最邻点的标签的平均值。
    
## 3.3 算法(sklearn上有三种)
http://scikit-learn.org/stable/modules/neighbors.html
