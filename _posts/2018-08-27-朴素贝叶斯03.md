---
layout:     post
title:      朴素贝叶斯项目案例之二
subtitle:   《机器学习实战九》
date:       2018-08-27
author:     Jang
header-img: img/post-bg-debug.png
catalog: true
tags:
    - MachineLearning
    - 机器学习实战
---

## 项目案例2：使用朴素贝叶斯过滤垃圾邮件<br>

## 项目概述<br>
完成朴素贝叶斯的一个最著名的应用：电子邮件垃圾过滤<br>

## 开发流程<br>
使用朴素贝叶斯对电子邮件进行分类<br>
```
收集数据：提供文本文件
准备数据：将文本文件解析成词条向量
分析数据：检查词条确保解析的正确性
训练算法：使用trainNB()函数
测试算法：使用朴素贝叶斯进行交叉验证
使用算法：构建一个完整的程序对一组文档进行分类，将错分的文档输出到屏幕上
```

### 收集数据: 提供文本文件<br>
文本文件的内容如下：<br>
```
Hi Peter,

With Jose out of town, do you want to
meet once in a while to keep things
going and do some interesting stuff?

Let me know
Eugene
```

### 准备数据：将文本文件解析成词条向量<br>
使用正则表达式来却分文本<br>
```
>>> mySent = 'This book is the best book on Python or M.L. I have ever laid eyes upon.'
>>> import re
>>> regEx = re.compile('\\W*')
>>> listOfTokens = regEx.split(mySent)
>>> listOfTokens
['This', 'book', 'is', 'the', 'best', 'book', 'on', 'Python', 'or', 'M.L.', 'I', 'have', 'ever', 'laid', 'eyes', 'upon', '']
```

### 分析数据：检查词条确保解析的正确性<br>

### 训练算法：使用trainNB0()函数
```

```

### 测试算法：使用朴素贝叶斯进行交叉验证<br。
文件解析及完成的垃圾邮件测试函数<br>
```
# 切分文本
def textParse(bigString):
    '''
    Desc:
        接收一个大字符串并将其解析为字符长列表
    Args:
        bigString -- 大字符串
    Returns:
        去掉少于2个字符的字符串，并将所有字符串转换为小写，返回字符串列表
    '''
    import re
    # 使用正则表达式来切分句子，其中分隔符是除单词、数字外的任意字符串
    listOfTokens = re.split(r'\W*', bigString)
    return [tok.lower() for tok in listOfTokens if len(tok) > 2]
    
def spamTest():
    '''
    Desc:
        对贝叶斯垃圾邮件分类器进行自动化处理
    Returns:
        对测试集中的每封邮件进行分类，若邮件分类错误，则错误数加1，最后返回总的错误百分比
    '''
    docList = []
    classList = []
    fullText = []
    for i in range(1, 26):
        # 切分，解析数据，并归类为1类别
        wordList = textParse(open('spam/%d.txt' %i).read())
        docList.append(wordList)
        classList.append(1)
        # 切分，解析数据，并归类为0类别
        wordList = textParse(open('ham/%d.txt' %i).read())
        docList.append(wordList)
        fullText.extend(wordList)
        classList.append(0)
    # 创建词汇表
    # print docList
    vocabList = createVocabList(docList)
    #print vocabList
    trainingSet = range(50)
    print trainingSet
    testSet = []
    # 随机取10个邮件用来测试
    for i in range(10):
        # random.uniform(x,y)随机生成一个范围为x - y的实数
        randIndex = int(random.uniform(0,len(trainingSet)))
        testSet.append(trainingSet[randIndex])
        del(trainingSet[randIndex])
    trainMat = []
    trainClasses = []
    for docIndex in trainingSet:
        trainMat.append(setOfWord2Vec(vocabList,docList[docIndex]))
        trainClasses.append(classList[docIndex])
    p0V,p1V,pSpam = trainNB0(array(trainMat),array(trainClasses))
    errorCount = 0
    for docIndex in testSet:
        wordVector = setOfWord2Vec(vocabList, docList[docIndex])
        if classifyNB(array(wordVector), p0V, p1V, pSpam) != classList[docIndex]:
            errorCount += 1
    print 'the errorCount is:', errorCount
    print 'the testSet length is:', len(testSet)
    print 'the error rate is:', float(errorCount)/len(testSet)
```

### 使用算法：构建一个完成的程序对一组文档进行分类，将错分的文档输出到屏幕上
